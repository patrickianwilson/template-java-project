buildscript {
    repositories {
        maven {
            url "http://repository.inquestdevops.com/repository/inquest-oss-releases/"
        }
        maven {
            url "https://plugins.gradle.org/m2/"
        }
        mavenCentral()
        mavenLocal()
    }
    dependencies {
        classpath "com.inquestdevops:WarblerBuildGradlePlugin:1.0.+"
        classpath "com.inquestdevops:WarblerPublishGradlePlugin:1.0.+"
        classpath "com.inquestdevops:ProjectTemplatesGradlePlugin:1.0.+"
        classpath "net.ltgt.gradle:gradle-apt-plugin:0.15"
    }
}


project.version = 'dev.1'
project.group = "com.github.patrickianwilson"

if (System.getenv("BUILD_NUMBER") != null) {
    def majorVersion = "1.0" //eventually override with a lookup
    def buildStream = "0"
    project.version = "${majorVersion}.${buildStream}.${System.getenv("BUILD_NUMBER")}"
}

ext {
    moduleName = "template-java-project" //change me!!
    dockerTag = "${project.moduleName.toLowerCase()}:latest"
    dockerFile = "$projectDir/src/main/deploy/Dockerfile"
    dockerImagePath="us.gcr.io/inlaid-citron-94802/services/${project.moduleName.toLowerCase()}:${project.version}"
}

apply plugin: "project.cardinal-service"
apply plugin: "publish.docker"

mainClassName="com.sample.cardinal.Runner"

task configureZip {
    finalizedBy distZip
    doLast {
        distZip.archiveName = "${moduleName}.zip"
        startScripts.applicationName = "${moduleName}"
    }
}

release.dependsOn "configureZip"


repositories {
    maven {
        url "http://repository.inquestdevops.com/repository/inquest-oss-releases/"
    }
    maven {
        url "http://repository.inquestdevops.com/repository/inquest-releases/"
        credentials {
            username = System.getenv("REPO_USER")
            password = System.getenv("REPO_PASSWORD")
        }
    }
    mavenLocal()
    mavenCentral()
}
dependencies {
    compile "com.github.patrickianwilson:AbstractDataRepositories-DatasourceGCPDatastore:1.0.0.+"
    compile "com.github.patrickianwilson:ServicePatterns:1.0.0.+"
    compile "com.github.patrickianwilson:RabbitAgentJaxRs:1.0.0.+"
    compile group: "com.github.patrickianwilson", name:"CardinalConfigUtils", version: "1.0.0.+"
    compile group: 'io.swagger.core.v3', name: 'swagger-jaxrs2', version: '2.0.6'
    compile group: 'io.swagger.core.v3', name: 'swagger-jaxrs2-servlet-initializer', version: '2.0.6'

    compile "com.beust:jcommander:1.72"
}

release.dependsOn "configureZip"

